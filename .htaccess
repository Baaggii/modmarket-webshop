RewriteEngine On

# React SPA fallback
RewriteCond %{REQUEST_URI} ^/erp
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^erp/?$ /erp/index.html [L]

# ERP frontend (PM2 serve → port 3001)
RewriteRule ^erp/(.*)$ http://127.0.0.1:3001/erp/$1 [P,L]
RewriteRule ^erp$ http://127.0.0.1:3001/erp/ [P,L]

# ERP API
RewriteRule ^api/(.*)$ http://127.0.0.1:3001/api/$1 [P,L]

<FilesMatch "^\\.env">
  Order allow,deny
  Deny from all
</FilesMatch>


# API-гийн бүх хүсэлтийг Node руу дамжуулна
#ProxyPass        /api  http://127.0.0.1:$PORT
#ProxyPassReverse /api  http://127.0.0.1:$PORT

# php -- BEGIN cPanel-generated handler, do not edit
# Set the “ea-php81” package as the default “PHP” programming language.
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php81 .php .php8 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit

# API-гийн бүх хүсэлтийг Node руу дамжуулна
# /home/modmark1/apps/modmarket-webshop/.htaccess

ProxyPass        /api  http://127.0.0.1:$PORT
ProxyPassReverse /api  http://127.0.0.1:$PORT

PassengerAppType        node
PassengerStartupFile    src/server.js
PassengerAppRoot        /home/modmark1/apps/modmarket-webshop
# хүсвэл дэлгэрэнгүй лог
PassengerAppLogFile     /home/modmark1/apps/modmarket-webshop/passenger_app.log
PassengerLogLevel       3

# php -- BEGIN cPanel-generated handler, do not edit
# Set the “ea-php81” package as the default “PHP” programming language.
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php81 .php .php8 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit
